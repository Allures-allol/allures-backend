# âœ… services/review_service/main.py

from fastapi import FastAPI
from fastapi.middleware.cors import CORSMiddleware
from services.review_service.db.database import init_db
from services.review_service.api.routes import router
#import nltk

# ğŸ“¦ Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° NLTK Ñ€ĞµÑÑƒÑ€ÑĞ¾Ğ²
#nltk.download('punkt')
#nltk.download('wordnet')

# ğŸš€ Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ FastAPI
app = FastAPI(title="Review Service")

# ğŸ”“ CORS â€” Ñ€Ğ°Ğ·Ñ€ĞµÑˆĞµĞ½Ğ½Ñ‹Ğµ Ğ¸ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸ĞºĞ¸
app.add_middleware(
    CORSMiddleware,
    allow_origins=[
        "http://localhost:3000",
        "http://127.0.0.1:3000",
        "https://allures-allol.com",
        "https://allures-frontend.vercel.app",
    ],
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

# ğŸ› ï¸ Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ† Ğ¿Ñ€Ğ¸ ÑÑ‚Ğ°Ñ€Ñ‚Ğµ
@app.on_event("startup")
def on_startup():
    init_db()

# ğŸ”— ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚Ğ¾Ğ²
app.include_router(router, prefix="/reviews", tags=["Reviews"])

# ğŸŒ ĞšĞ¾Ñ€Ğ½ĞµĞ²Ğ¾Ğ¹ Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚
@app.get("/")
def root():
    return {"message": "Review Service is running"}
